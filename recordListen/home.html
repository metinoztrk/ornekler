<!DOCTYPE html>
<html> 
    <head>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        <style>
            #parent {
                display: flex;
                margin: 10px;
            }
            #filterButton {
                margin-left: 10px;
            }
            #main {
                display: flex;
                flex-direction: row;
                margin: 10px;
            }
            #text {
                margin-right: 10px;
                margin-left: 10px;
                margin-top: 16px;
                text-align: center;
            }
            #bitisDate {
                border-width: 0px;
            }
            #baslangicDate {
                border-width: 0px;
            }
            #progress {
                margin: 15px;
                display: none;
            }
            #text2 {
                text-align: center;
                display: none;
            }
            #durum {
                margin-left: 10px;
                width: 250px;
            }
            h2.headerText {
                text-align: center;
            }
            .my-custom-scrollbar {
                position: relative;
                height: auto;
                overflow: auto;
                margin: 15px;
            }
            .table-wrapper-scroll-y {
                display: block;
                height: 650px;
            }
            .table-wrapper-scroll {
                display: block;
                height: 40px;
            }
            .my-custom-scrollbar-header {
                margin: 15px;
                height: auto;
                overflow: auto;
            }
            .form-group{
                display: flex;
                flex-direction: row;
                margin-bottom: 10px;
                margin: 10px;
                width: 250px;
            }
            #label {
                margin-top: 5px;
                margin-right: 10px;
                align-items: center;
            }
            #myTable2 {
                margin-bottom: 0rem;
            }
        </style>
    </head>
<body>
    <script>
      let ipc = require('electron').ipcRenderer;
      const moment = require('moment');
      ipc.send("ready","çalistir")
      function durumSec () {
        let durum = ""
        durum = document.getElementById("durum").value
        //console.log(durum)
      }
      function getFilter() {
        let filterData = {
            baslangic_tarih: "",
            bitis_tarih: "",
            durum: "",
            arayan: "",
            aranan: "",
        }
        $("#myTable > tbody").empty();
        filterData.baslangic_tarih = document.getElementById("baslangicDate").value
        filterData.bitis_tarih = document.getElementById("bitisDate").value
        filterData.durum = document.getElementById("durum").value
        filterData.arayan = document.getElementById("arayan").value
        filterData.aranan = document.getElementById("aranan").value
        filterData.baslangic_tarih = moment(filterData.baslangic_tarih, 'YYYY-MM-DD').subtract(1,'day').format('YYYY-MM-DD')
        // filterData.bitis_tarih = moment(filterData.bitis_tarih).format('DD-MM-YYYY HH:mm')*/ 
        //console.log(filterData)
        ipc.send("getFilter",filterData)
      }
      ipc.on('getFilterRes',(event,arg) => {
          //console.log(arg)
          arg.forEach(function(item) {
               $("#myTable").find('tbody')
               .append($('<tr id="myTableRow">')
                   .append($('<td>')
                       .append(item.unique_id)
                   )
                   .append($('<td>')
                       .append(item.kaynak)
                   )
                   .append($('<td>')
                       .append(item.hedef)
                   )
                   .append($('<td>')
                       .append(item.cevaplayanlar)
                   )
                   .append($('<td>')
                       .append(item.durum)
                   )
                   .append($('<td>')
                       .append(item.zaman)
                   )
                   .append($('<td>')
                       .append( `<audio controls>
                                    <source src="file:${item.url}" type="audio/wav">
                                </audio>`
                              )            
                    )
               );
           })
      })  
    </script>
        <div>
            <div id="main">
                <p id="text">Başlangıç Tarihi Seçiniz:</p>
                <input type="date" name="bday" id="baslangicDate">
            </div>
            <div id="main">
                <p id="text">Bitiş Tarihi Seçiniz:</p> 
                <input type="date" name="bday" id="bitisDate">
            </div>
            <div class="form-group">
                <label for="Email" id="label">Arayan:</label>
                <input name="arayan" id="arayan" class="form-control"/>
            </div>
            <div class="form-group">
                <label for="Email" id="label">Aranan:</label>
                <input name="aranan" id="aranan" class="form-control"/>
            </div>
            <select class="browser-default custom-select" id="durum" onclick=durumSec()>
                <option value="Hepsi">Hepsi</option>
                <option value="Cevaplandı">Cevaplandı</option>
                <option value="Cevaplanmadı">Cevaplanmadı</option>
            </select>
            <div id="parent">
              <div id="filterButton">
                  <button class="btn btn-success" id="getFilter" onclick="getFilter()">Filtrele</button>
              </div>
            </div>
            <h2 class="headerText">Çağrı Listesi</h2>
            <div class="table-wrapper-scroll my-custom-scrollbar-header">
                <table id="myTable2" class="table">
                    <thead>
                    <tr>
                        <th scope="col" style="width: 187px;">Unique Id</th>
                        <th scope="col" style="width: 237px;">Arayan</th>
                        <th scope="col" style="width: 215px;">Aranan</th>
                        <th scope="col" style="width: 110px;">Cevaplayan</th>
                        <th scope="col" style="width: 190px;">Durum</th>
                        <th scope="col" style="width: 312px;">Zaman</th>
                        <th scope="col" style="width: 555px;">Ses</th>
                    </tr>
                    </thead>
                </table>
            </div>
            <div class="table-wrapper-scroll-y my-custom-scrollbar">
                <table id="myTable" class="table">
                    <tbody>
                    </tbody>
                </table>
            </div>
        </div>
</body>
<script>window.$ = window.jQuery = require('jquery');</script>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

</html>